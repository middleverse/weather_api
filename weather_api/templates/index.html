{% extends "base.html" %}

{% block content %}

<h1>Hello, world!</h1>

<form method="GET" action="/v1/api/">
  <label for="fname">Enter City:</label><br>
  <input type="text" id="city" name="city"><br>
  <input type="submit">
</form>

<script>
// JAVASCRIPT
// ==========
document.getElementById('game-config-form').addEventListener('submit', function(event) {
    event.preventDefault();
    const form = event.target
    const form_data = new FormData(form)
    const division = form_data.getAll('division')
    const shot_clock = form_data.get('shot_clock')
    const url = form.getAttribute('action')
    const method = 'post'
    const xhr = new XMLHttpRequest()
    const responseType = 'json'
    xhr.open(method, url) // make the request 
    xhr.setRequestHeader('HTTP_X_REQUESTED_WITH', 'XMLHttpRequest') // convetion to call setRequestHeader is after open and before send
    xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest')
    
    xhr.onload = function() {
        if (xhr.status === 201) {
            const r = xhr.response
            r_json = JSON.parse(r)

            court_socket.send(JSON.stringify({
                'message_type': 'create_game', // analagous to create lobby
                'shot_clock': shot_clock,
                'division': division
            }));
        }     
        else {
            const r = xhr.response
            console.log(r)
        }
    }

    xhr.onerror = function() {
            alert("An error has occurred.")
    }
    
    xhr.send(form_data)
    
    
});   
</script>

{% endblock %}